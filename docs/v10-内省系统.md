# V10: 内省系统

> 核心哲学: 要改变自己，先要看见自己。

V10 在 V9 基础上新增 `IntrospectionSystem`，让 Agent 具备观察和分析自己行为的能力。

---

## V9 vs V10

| 维度 | V9 | V10 |
|---|---|---|
| 工具数 | 36 | 39 |
| 新增工具 | - | `introspect_stats/patterns/reflect/logs` |
| 新目录 | `.sessions/` | `.introspection/` |
| 代码规模 | 1527 行 | 1782 行 |

---

## IntrospectionSystem 核心能力

### 行为日志

每次工具调用自动记录：
- 工具名称
- 输入参数
- 输出结果
- 执行时间
- 上下文信息

### 模式分析

识别重复的行为模式：
- 工具使用频率
- 常见工具组合
- 时间分布特征

### 自我反思

生成结构化反思报告：
- 决策质量评估
- 改进空间识别
- 行为趋势分析

---

## 4 个内省工��

```typescript
introspect_stats()      // 查看行为统计
introspect_patterns()   // 分析行为模式
introspect_reflect()    // 生成自我反思报告
introspect_logs(limit?) // 查看行为日志
```

---

## 典型使用场景

### 调试优化

```text
用户: 你最近都在做什么？
Agent: [调用 introspect_stats]
       过�� 24 小时执行了 47 次工具调用，
       最常用: read_file (18次), bash (12次)...
```

### 模式发现

```text
用户: 分析一下你的行为模式
Agent: [调用 introspect_patterns]
       发现模式: 每次编辑文件前都会先读取
       建议: 可以考虑合并读写操作...
```

### 自我反思

```text
用户: 反思一下今天的工作
Agent: [调用 introspect_reflect]
       生成报告: 完成 5 个任务，2 个需要重试
       改进点: 文件路径错误导致 3 次重试...
```

---

## 数据存储

```text
.introspection/
├── logs/
│   ├── 2024-01-15.jsonl    # 每日行为日志
│   └── 2024-01-16.jsonl
└── reports/
    └── reflect-2024-01-16.md  # 反思报告
```

---

## 演进意义

V10 是通往自进化的第一步：

```text
V10: 观察 (当前)
  -> 反思
  -> 识别模式
  -> V11: 修改自己 (未来)
```

只有先看见自己的行为，才能有针对性地改进。

---

## 与 V8 心跳的关系

| 系统 | 关注点 | 触��方式 |
|---|---|---|
| V8 心跳 | 外部世界变化 | 定时触发 |
| V10 内省 | 自身行为模式 | 按需调用 |

两者互补：心跳让 Agent 主动关注外部，内省让 Agent 主动关注自身。

---

## 下一步

基于内省数据，可能的演进方向：
- 自动调整工具选择策略
- 基于历史优化决策
- 自我修改行为规则
