# V5: Skill ç³»ç»Ÿ

> **æ ¸å¿ƒå“²å­¦**: "Agent éœ€è¦ä¸“ä¸šçŸ¥è¯†ï¼Œä½†ä¸éœ€è¦é‡æ–°è®­ç»ƒ"

## ä¸ºä»€ä¹ˆéœ€è¦ Skillï¼Ÿ

V4 çš„ Agent èƒ½åè°ƒå­ä»£ç†ï¼Œä½†é¢å¯¹ä¸“ä¸šé¢†åŸŸä»»åŠ¡æ—¶ï¼Œä»ç„¶ä¾èµ–æ¨¡å‹çš„é€šç”¨çŸ¥è¯†ã€‚é—®é¢˜ï¼š

1. **çŸ¥è¯†æœ‰é™**: æ¨¡å‹è®­ç»ƒæ•°ï¿½ï¿½æœ‰æˆªæ­¢æ—¥æœŸ
2. **é¢†åŸŸä¸“ä¸š**: ç‰¹å®šé¢†åŸŸéœ€è¦ä¸“ä¸šæŒ‡å¯¼
3. **ä¸Šä¸‹æ–‡æ±¡æŸ“**: æŠŠæ‰€æœ‰çŸ¥è¯†æ”¾å…¥ç³»ç»Ÿæç¤ºä¼šæ±¡æŸ“ä¸Šä¸‹æ–‡

V5 å¼•å…¥ Skill ç³»ç»Ÿï¼š
- **çŸ¥è¯†å¤–éƒ¨åŒ–**: ä¸“ä¸šçŸ¥è¯†å­˜å‚¨åœ¨ SKILL.md æ–‡ä»¶ä¸­
- **æŒ‰éœ€åŠ è½½**: åªåœ¨éœ€è¦æ—¶åŠ è½½ï¼Œä¸æ±¡æŸ“ç³»ç»Ÿæç¤º
- **ç¼“å­˜å‹å¥½**: Skill å†…å®¹ä½œä¸º tool_result æ³¨å…¥

---

## æ ¸å¿ƒè®¾è®¡

### SKILL.md æ ¼å¼

```markdown
---
name: code-review
description: ä»£ç å®¡æŸ¥ä¸“å®¶ï¼Œæä¾›ä¸“ä¸šçš„ä»£ç å®¡æŸ¥æŒ‡å¯¼
---

# ä»£ç å®¡æŸ¥æŒ‡å—

## å®¡æŸ¥ç»´åº¦

1. **å¯è¯»æ€§**
   - å‘½åæ˜¯å¦æ¸…æ™°
   - æ³¨é‡Šæ˜¯å¦å……åˆ†

2. **å®‰å…¨æ€§**
   - è¾“å…¥éªŒè¯
   - SQL æ³¨å…¥é˜²æŠ¤

3. **æ€§èƒ½**
   - ç®—æ³•å¤æ‚åº¦
   - å†…å­˜ä½¿ç”¨

## å®¡æŸ¥æµç¨‹

1. å…ˆçœ‹æ•´ä½“ç»“æ„
2. å†çœ‹å…³é”®è·¯å¾„
3. æœ€åçœ‹è¾¹ç•Œæƒ…å†µ
```

**æ ¼å¼è¯´æ˜**:
- YAML frontmatter: `name` å’Œ `description`
- Markdown body: ä¸“ä¸šçŸ¥è¯†å†…å®¹

### SkillLoader ç±»

```typescript
class SkillLoader {
  private skillsDir: string;
  private skills: Map<string, Skill> = new Map();

  constructor() {
    this.skillsDir = SKILL_DIR;
    this.loadSkills();
  }

  // è§£æ SKILL.md æ–‡ä»¶
  private parseSkillFile(filePath: string): Skill | null {
    const content = fs.readFileSync(filePath, "utf-8");

    // åŒ¹é… ---\nYAML\n---\nMarkdown æ ¼å¼
    const match = content.match(/^---\s*\n([\s\S]*?)\n---\s*\n([\s\S]*)$/);
    if (!match) return null;

    const yamlContent = match[1];
    const markdownContent = match[2].trim();

    // ç®€å• YAML è§£æ
    const name = yamlContent.match(/name:\s*(.+)/)?.[1]?.trim();
    const description = yamlContent.match(/description:\s*(.+)/)?.[1]?.trim();

    if (!name || !description) return null;

    return { name, description, content: markdownContent, path: filePath };
  }

  // åŠ è½½æŒ‡å®š skill çš„å®Œæ•´å†…å®¹
  loadSkill(name: string): string {
    const skill = this.skills.get(name);
    if (!skill) return `é”™è¯¯: æŠ€èƒ½ '${name}' ä¸å­˜åœ¨`;
    return `<skill-loaded name="${name}">\n${skill.content}\n</skill-loaded>\n\nè¯·æŒ‰ç…§ä¸Šè¿°æŠ€èƒ½æ–‡æ¡£çš„æŒ‡å¼•å®Œæˆä»»åŠ¡ã€‚`;
  }
}
```

---

## Skill å·¥å…·

```typescript
{
  name: "Skill",
  description: "åŠ è½½é¢†åŸŸæŠ€èƒ½ä»¥è·å¾—ä¸“ä¸šçŸ¥è¯†ã€‚å½“ä»»åŠ¡æ¶‰åŠç‰¹å®šé¢†åŸŸæ—¶ç«‹å³è°ƒç”¨",
  input_schema: {
    type: "object",
    properties: {
      skill: { type: "string", description: "æŠ€èƒ½åç§°" }
    },
    required: ["skill"]
  }
}
```

---

## å·¥ä½œæµç¨‹ç¤ºä¾‹

### ç”¨æˆ·è¯·æ±‚

```
ç”¨æˆ·: å¸®æˆ‘å®¡æŸ¥ api.ts çš„ä»£ç 
```

### Agent åŠ è½½ Skill

```typescript
// Agent è¯†åˆ«åˆ°éœ€è¦ä»£ç å®¡æŸ¥ä¸“ä¸šçŸ¥è¯†
// è°ƒç”¨ Skill å·¥å…·
{ skill: "code-review" }
```

### Skill æ³¨å…¥

```
<skill-loaded name="code-review">
# ä»£ç å®¡æŸ¥æŒ‡å—

## å®¡æŸ¥ç»´åº¦
1. **å¯è¯»æ€§** - å‘½åæ˜¯å¦æ¸…æ™°...
2. **å®‰å…¨æ€§** - è¾“å…¥éªŒè¯...
3. **æ€§èƒ½** - ç®—æ³•å¤æ‚åº¦...

## å®¡æŸ¥æµç¨‹
1. å…ˆçœ‹æ•´ä½“ç»“æ„
2. å†çœ‹å…³é”®è·¯å¾„
3. æœ€åçœ‹è¾¹ç•Œæƒ…å†µ
</skill-loaded>

è¯·æŒ‰ç…§ä¸Šè¿°æŠ€èƒ½æ–‡æ¡£çš„æŒ‡å¼•å®Œæˆä»»åŠ¡ã€‚
```

### Agent æ‰§è¡Œ

Agent ç°åœ¨æœ‰äº†ä¸“ä¸šçŸ¥è¯†ï¼ŒæŒ‰ç…§ Skill æŒ‡å¯¼è¿›è¡Œä»£ç å®¡æŸ¥ã€‚

---

## ç³»ç»Ÿæç¤ºçš„å˜åŒ–

V5 çš„ç³»ç»Ÿæç¤ºåŒ…å«å¯ç”¨ Skill åˆ—è¡¨ï¼š

```typescript
const SYSTEM = `ä½ æ˜¯ OpenClaw V5 - Skill å¢å¼ºå‹ Agentï¼Œå·¥ä½œç›®å½•: ${WORKDIR}

## ğŸš¨ ç¬¬ä¸€ä¼˜å…ˆçº§ï¼šSkill åŠ è½½

**å¯ç”¨ Skills:**
${skillLoader.getDescriptions()}

**å¼ºåˆ¶è§„åˆ™ï¼š**
1. æ”¶åˆ°ä»»åŠ¡åï¼Œ**ç¬¬ä¸€æ­¥å¿…é¡»**æ£€æŸ¥æ˜¯å¦æœ‰åŒ¹é…çš„ Skill
2. å¦‚æœä»»åŠ¡æ¶‰åŠä¸Šè¿°ä»»ä½• Skill çš„é¢†åŸŸï¼Œ**å¿…é¡»å…ˆè°ƒç”¨ Skill å·¥å…·åŠ è½½**
3. åªæœ‰åŠ è½½ Skill åï¼Œæ‰èƒ½å¼€å§‹è§„åˆ’å’Œæ‰§è¡Œ
4. ä¸ç¡®å®šæ—¶ï¼Œç”¨ Skill({ skill: "list" }) æŸ¥çœ‹å®Œæ•´åˆ—è¡¨

âš ï¸ è¿åæ­¤è§„åˆ™ = ä»»åŠ¡å¤±è´¥ã€‚å¿…é¡»å…ˆ Skill å·¥å…·ï¼Œå† TodoWriteã€‚

## å·¥ä½œå¾ªç¯
1. **identify** - è¯†åˆ«ä»»åŠ¡ç±»å‹
2. **load skill** - ğŸš¨ åŠ è½½åŒ¹é…çš„ Skillï¼ˆå¿…é¡»ï¼ï¼‰
3. **plan** - ç”¨ TodoWrite è§„åˆ’ä»»åŠ¡
4. **execute** - æŒ‰ Skill æŒ‡å¼•æ‰§è¡Œ
5. **track** - æ›´æ–°ä»»åŠ¡çŠ¶æ€

## å­ä»£ç†ç³»ç»Ÿ (ç»§æ‰¿ V4)
å·¥å…·: subagent - å§”æ‰˜å­ä»»åŠ¡ç»™éš”ç¦»è¿›ç¨‹

## ä»»åŠ¡è§„åˆ’ç³»ç»Ÿ (ç»§æ‰¿ V3)
å·¥å…·: TodoWrite - æ›´æ–°ä»»åŠ¡åˆ—è¡¨ï¼ˆæ›¿æ¢å¼ï¼‰
- æœ€å¤š 20 ä¸ªä»»åŠ¡ï¼ŒåŒæ—¶åªèƒ½ 1 ä¸ª in_progress`;
```

---

## ç›®ï¿½ï¿½ï¿½ç»“æ„

```
skills/
â”œâ”€â”€ code-review/
â”‚   â””â”€â”€ SKILL.md
â”œâ”€â”€ security-audit/
â”‚   â””â”€â”€ SKILL.md
â”œâ”€â”€ performance-tuning/
â”‚   â””â”€â”€ SKILL.md
â””â”€â”€ api-design/
    â””â”€â”€ SKILL.md
```

æ¯ä¸ª Skill æ˜¯ä¸€ä¸ªç›®å½•ï¼ŒåŒ…å« `SKILL.md` æ–‡ä»¶ã€‚

---

## ä¸ V4 çš„å¯¹æ¯”

| ç‰¹æ€§ | V4 | V5 |
|------|----|----|
| å­ä»£ç† | âœ… | âœ… |
| ä¸“ä¸šçŸ¥è¯† | âŒ ä¾èµ–æ¨¡å‹é€šç”¨çŸ¥è¯† | âœ… å¯åŠ è½½ Skill |
| çŸ¥è¯†æ›´æ–° | âŒ éœ€è¦é‡æ–°è®­ç»ƒ | âœ… ä¿®æ”¹ SKILL.md å³å¯ |
| ä¸Šä¸‹æ–‡ç®¡ç† | âŒ | âœ… æŒ‰éœ€åŠ è½½ |

---

## å…³é”®æ´å¯Ÿ

1. **çŸ¥è¯†å¤–éƒ¨åŒ–**: ä¸“ä¸šçŸ¥è¯†ä¸åº”ç¡¬ç¼–ç åœ¨ç³»ç»Ÿæç¤ºä¸­
2. **æŒ‰éœ€åŠ è½½**: åªåœ¨éœ€è¦æ—¶åŠ è½½ï¼ŒèŠ‚çœä¸Šä¸‹æ–‡
3. **æ˜“äºæ›´æ–°**: ä¿®æ”¹ Markdown æ–‡ä»¶å³å¯æ›´æ–°çŸ¥è¯†
4. **ç¼“å­˜å‹å¥½**: ä½œä¸º tool_result æ³¨å…¥ï¼Œåˆ©ç”¨ API ç¼“å­˜

---

## åˆ›å»ºè‡ªå®šä¹‰ Skill

1. åˆ›å»ºç›®å½•: `skills/my-skill/`
2. åˆ›å»ºæ–‡ä»¶: `skills/my-skill/SKILL.md`
3. ç¼–å†™å†…å®¹:

```markdown
---
name: my-skill
description: æˆ‘çš„è‡ªå®šä¹‰æŠ€èƒ½æè¿°
---

# æŠ€èƒ½æ ‡é¢˜

## ä½¿ç”¨æŒ‡å—

...ä¸“ä¸šçŸ¥è¯†å†…å®¹...
```

4. é‡å¯ Agentï¼ŒSkill è‡ªåŠ¨åŠ è½½

---

## ä¸‹ä¸€æ­¥

V5 çš„ Agent èƒ½åŠ è½½ä¸“ä¸šçŸ¥è¯†äº†ï¼Œä½†å®ƒçš„"äººæ ¼"æ˜¯å›ºå®šçš„ã€‚V6 å°†å¼•å…¥èº«ä»½ç³»ç»Ÿï¼Œè®© Agent èƒ½åˆ‡æ¢ä¸åŒçš„äººæ ¼å’Œè¡Œä¸ºæ¨¡å¼ã€‚
